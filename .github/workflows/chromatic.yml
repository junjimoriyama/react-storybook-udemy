# Workflow name
name: 'Chromatic Publish'

# git pushã—ãŸã¨ãã«GitHubActionsã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’è‡ªå‹•å®Ÿè¡Œ
on: push

# å‡¦ç†ã®å¡Š
jobs:
# å‡¦ç†ã®å¡Šã«å¯¾ã—ã¦ã®åå‰
  test:
    # ubuntuã§å®Ÿè¡Œ
    runs-on: ubuntu-latest
    # ã‚¸ãƒ§ãƒ–å†…ã§å®Ÿè¡Œã™ã‚‹å‡¦ç†ãƒªã‚¹ãƒˆ
    steps:
    # GitHub ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’å–å¾—
      - uses: actions/checkout@v4
      # with: ã¯ uses: ã§å®Ÿè¡Œã™ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«å¯¾ã—ã¦è¨­å®šå€¤ã‚’æ¸¡ã™
        with:
      # å…¨å±¥æ­´å–å¾—
          fetch-depth: 0
      # # Node.jsã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
      - uses: actions/setup-node@v4
      # Node.js 20 ã‚’ä½¿ç”¨
        with:
          node-version: 20
          # å‰å›ã®node_modules ã‚„ ~/.npm ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å†åˆ©ç”¨
          cache: 'npm'
          # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«(å¿…é ˆ)
      - run: npm install
      # Chromatic ã® GitHub Actionï¼‰ã‚’å®Ÿè¡Œã—ã€storybookã‚’ãƒ‡ãƒ—ãƒ­ã‚¤
      - uses: chromaui/action@latest
      # with: ã¯ uses: ã§å®Ÿè¡Œã™ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«å¯¾ã—ã¦è¨­å®šå€¤ã‚’æ¸¡ã™
        with:
          #ğŸ‘‡Chromatic ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆAPIèªè¨¼ç”¨ï¼‰
          projectToken: ${{ secrets.CHROMATIC_PROJECT_TOKEN }}
          # GitHub ãƒªãƒã‚¸ãƒˆãƒªã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³
          token: ${{ secrets.GITHUB_TOKEN }}

# ã‚¹ãƒ†ãƒƒãƒ—	èª¬æ˜
# 1. on: push	git push ã§ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’èµ·å‹•
# 2. checkout@v4	GitHub ãƒªãƒã‚¸ãƒˆãƒªã®ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—
# 3. setup-node@v4	Node.js 20 ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ‰åŠ¹åŒ–ï¼‰
# 4. npm install	package.json ã®ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
# 5. chromaui/action@latest	Chromatic ã« Storybook ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤